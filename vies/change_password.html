<!DOCTYPE html>
<html>
  <head>
    <title>Изменение пароля</title>
    <meta charset="utf-8" />
  </head>
  <body>
    <h1>Изменение пароля</h1>
    <form action="/change_password" method="post">
      <label>Старый пароль</label><br />
      <input
        type="password"
        name="old_password"
        onkeyup="KeyUp()"
        required
      /><br /><br />
      <label>Новый пароль</label><br />
      <input
        type="password"
        name="new_password1"
        onkeyup="KeyUp()"
        required
      /><br /><br />
      <label>Еще раз</label><br />
      <input
        type="password"
        name="new_password2"
        onkeyup="KeyUp()"
        required
      /><br /><br />
      <button class="sub" type="submit">Изменить</button>
    </form>
    <br />
    <div><h2 class="error"></h2></div>
    <br />

    <script>
      function KeyUp() {
        // Выполняем скрипт при изменении содержимого 2-го поля
        var old_value_input =
          document.getElementsByName("old_password")[0].value;
        var value_input1 = document.getElementsByName("new_password1")[0].value; // Получаем содержимое 1-го поля
        var value_input2 = document.getElementsByName("new_password2")[0].value; // Получаем содержимое 2-го поля
        if (old_value_input === value_input1) {
          document.getElementsByClassName("error")[0].innerHTML =
            "Новый пароль не должен совпадать со старым."; // Выводим сообщение
          document
            .getElementsByClassName("sub")[0]
            .setAttribute("disabled", "disabled"); // Запрещаем отправку формы
        } else if (value_input1 != value_input2) {
          // Условие, если поля не совпадают
          document.getElementsByClassName("error")[0].innerHTML =
            "Пароли не совпадают!"; // Выводим сообщение
          document
            .getElementsByClassName("sub")[0]
            .setAttribute("disabled", "disabled"); // Запрещаем отправку формы
        } else {
          // Условие, если поля совпадают
          document.getElementsByClassName("sub")[0].removeAttribute("disabled"); // Разрешаем отправку формы
          document.getElementsByClassName("error")[0].innerHTML = ""; // Скрываем сообщение
        }
      }
    </script>
  </body>
</html>
